# Курсовая работа

## План
1. Менифестом terraform описать создание виртуальных хостов с возможностью задавать их количесво в переменных,
2. Собрать образы приложений crawler и ui,
3. Написать ansible playbooks по автоматической установке docker на хосты,
4. Написать docker stack по деплою сервисов rabbitmq, mongodb, crawler и ui в docker swarm,
5. Развернуть Prometheus для сбора метрик c сервисов и хостов инфраструктуры,
6. Развернуть стек ELK для сбора логов с сервисов,
7. Развернуть GitLab и настроить pipline для пересборки docker образов и деплою в docker swarm сервисов crawler и ui при обновления кодовой базы последних,
8. Развернуть проксирующий nginx с ssl шифрованием, что бы спрятать за ним приложение, Prometheus и ELK
9. Настроить registry для docker образов в GitLab, вновь собранные контейнеры отправлять туда,
10. Максимально автоматизировать развертывание инфраструктуры.

### Terraform
Terraform манифест находится в каталоге terraform/
Версия не финальная, в дальнейшем в него интегрирую запуск ansible скриптов для автоматизации развертывания сервисов
За основу взял версию Ubuntu 20.04

### Сборка docker образов приложений
Образы crawler и ui собираются на основе python:3.9-alpine
Docker файлы для сборки хранятся в ms/search_engine_crawler/ и ms/search_engine_ui/

### Ansible
Написаны несколько плейбуков (ansible/playbooks/) для автоматизации установки docker и docker compose на Ubuntu 20.04
Написан плейбук по деплою приложения в docker  

### Деплой приложения в docker 
Пока написан docker compose для автоматического развертывания через ansible playbook сервисов rabbitmq, mongodb, crawler и ui
Пока сервис работает без https и доступен по адресу http://51.250.66.151/

### Пересборка приложения при оновлении кодовой базы
Поднят GitLab для дальнейшей настройки на его основе pipline для развертывания инфраструктуры под приложения и деплоя самого приложения 
